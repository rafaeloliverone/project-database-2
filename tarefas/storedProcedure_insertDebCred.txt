CREATE OR REPLACE PROCEDURE insertDebCred(mes text, ano text)
AS $$
DECLARE
	cursorDebCred NO SCROLL CURSOR
	FOR SELECT * FROM sumarizadaMovDebCred(mes,ano);
	rec RECORD;
BEGIN 
	OPEN cursorDebCred;
		LOOP
			FETCH cursorDebCred INTO rec;
			EXIT WHEN NOT FOUND;
				IF rec.NumConta IN (SELECT NumConta FROM Contas) THEN
					IF rec.NumConta IN (SELECT NumConta FROM DebCred) THEN
						IF mesano da conta já existe ...
						raise notice 'faltando fazer update';
					ELSE 
						INSERT INTO public.debcred(numconta, mesano, credito, debito)
						VALUES (rec.NumConta, rec.mesano, rec.credito, rec.debito);
					END IF;
				ELSE 
					RAISE NOTICE 'Conta não cadastrada na tabela contas';
				END IF;
				
		END LOOP;
	CLOSE cursorDebCred;
END;$$
LANGUAGE plpgsql;

CALL insertDebCred('06','2019');
